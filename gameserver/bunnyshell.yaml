kind: Environment
name: GameServer
type: primary
components:
  -
    kind: KubernetesManifest
    name: simple-game-server-fleet
    runnerImage: 'alpine/k8s:1.22.15'
    deploy:
      - 'kustomize create --autodetect --recursive --labels=app.kubernetes.io/instance-simple-game-server-fleet:bns,app.kubernetes.io/part-of:env-{{ env.unique }} --namespace {{ env.k8s.namespace }}'
      - 'kubectl apply -k '
    destroy:
      - 'kustomize create --autodetect --recursive --namespace {{ env.k8s.namespace }}'
      - 'kubectl delete -k .'
    start:
      - 'kubectl scale --replicas=5 --namespace {{ env.k8s.namespace }} deployment/simple-game-server-fleet'
    stop:
      - 'kubectl scale --replicas=0 --namespace {{ env.k8s.namespace }} deployment/simple-game-server-fleet'
    exportVariables:
      - SERVICE_ENDPOINT
    gitRepo: 'https://github.com/aminalali8/agones-helm.git'
    gitBranch: main
    gitApplicationPath: /gameserver/k8s/